let people = [];
let expenses = [];

function addNameFields() {
  const numPeople = document.getElementById('numPeople').value;
  if (numPeople < 1) return;

  let nameFields = '';
  for (let i = 0; i < numPeople; i++) {
    nameFields += `<label for="name${i}">Name of Person ${i + 1}:</label>
                   <input type="text" id="name${i}"><br>`;
  }
  document.getElementById('nameFields').innerHTML = nameFields;
  document.getElementById('step1').style.display = 'none';
  document.getElementById('step2').style.display = 'block';
}

function addExpenseFields() {
  const numPeople = document.getElementById('numPeople').value;
  people = [];
  for (let i = 0; i < numPeople; i++) {
    const name = document.getElementById(`name${i}`).value;
    people.push({ name, totalSpent: 0 });
  }

  let expenseFields = '';
  for (let i = 0; i < numPeople; i++) {
    expenseFields += `<label for="expense${i}">Expenses for ${people[i].name}:</label>
                      <input type="number" id="expense${i}" min="0"><br>`;
  }
  document.getElementById('expenseFields').innerHTML = expenseFields;
  document.getElementById('step2').style.display = 'none';
  document.getElementById('step3').style.display = 'block';
}

function calculateExpenses() {
  const numPeople = document.getElementById('numPeople').value;
  let totalExpenses = 0;

  for (let i = 0; i < numPeople; i++) {
    const expense = parseFloat(document.getElementById(`expense${i}`).value) || 0;
    people[i].totalSpent = expense;
    totalExpenses += expense;
  }

  const equalShare = totalExpenses / numPeople;
  let results = `<p>Total Expenses: $${totalExpenses.toFixed(2)}</p>
                 <p>Each person should pay: $${equalShare.toFixed(2)}</p>`;

  for (let i = 0; i < numPeople; i++) {
    const balance = people[i].totalSpent - equalShare;
    results += `<p>${people[i].name} ${balance >= 0 ? 'owes' : 'is owed'}: $${Math.abs(balance).toFixed(2)}</p>`;
  }

  document.getElementById('results').innerHTML = results;
  document.getElementById('step3').style.display = 'none';
  document.getElementById('step4').style.display = 'block';
}